
# –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è –æ–±—ë—Ä—Ç–∫–∏ `neosintez_api`

> **–í–µ—Ä—Å–∏—è:** 0.2 (26¬†–∏—é–Ω—è¬†2025)  
> **–ê–≤—Ç–æ—Ä:** ChatGPT

---

## 1. –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–ø—Ä—è—Ç–∞—Ç—å –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ REST‚ÄëAPI –ù–µ–æ—Å–∏–Ω—Ç–µ–∑–∞ –∑–∞ ¬´pythonic¬ª¬†–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, —á—Ç–æ–±—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –æ–ø–µ—Ä–∏—Ä–æ–≤–∞–ª **Pydantic‚Äë–º–æ–¥–µ–ª—è–º–∏**, –∞ –Ω–µ JSON‚Äë—Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏, –∏ –º–æ–≥:

1. –°–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã (`create`).
2. –ß–∏—Ç–∞—Ç—å/–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –≤ –º–æ–¥–µ–ª–∏ (`read`).
3. –ú–∞—Å—Å–æ–≤–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel.
4. –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Å–ª–æ–π –¥–ª—è –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (CSV, –ë–î, Web).

---

## 2. –¢–µ–∫—É—â–∞—è —Ç–æ—á–∫–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°–æ—Å—Ç–æ—è–Ω–∏–µ | –ü—Ä–æ–±–ª–µ–º—ã |
|-----------|-----------|----------|
| PoC‚Äë—Å–∫—Ä–∏–ø—Ç `create ‚Üí read` | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –õ–æ–≥–∏–∫–∞ ¬´—Ä–∞–∑–º–∞–∑–∞–Ω–∞¬ª –ø–æ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É |
| REST‚Äë–∫–ª–∏–µ–Ω—Ç `NeosintezClient` | ‚ö† –ú–∏–Ω–∏–º—É–º –º–µ—Ç–æ–¥–æ–≤ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–π `._request`, —Å–ª–∞–±–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è |
| –ö—ç—à `ENTITY_CACHE` | ‚úÖ –í –ø–∞–º—è—Ç–∏ | –ù–µ—Ç TTL / –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |
| Swagger (`swagger.json`) | ‚úÖ –ü–æ–ª–Ω—ã–π | –ú–µ—Ç–æ–¥—ã –Ω–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã |
| –¢–µ—Å—Ç—ã | ‚ùå | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| –ú–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç –∏–∑ Excel | ‚ùå | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |

---

## 3. –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (3¬†—Å–ª–æ—è)

```
Pydantic Model  ‚Üí  Service Layer  ‚Üí  Core SDK  ‚Üí  REST API (Neosintez)
```

| –°–ª–æ–π | –ü–∞–ø–∫–∞ | –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã |
|------|-------|-----------------|
| **Domain** | `models/` | `Pump(BaseModel)`,¬†`Folder(BaseModel)` |
| **Service** | `neosintez_api/services/` | `ObjectService`,¬†`MetadataCache` |
| **Core SDK** | `neosintez_api/core/` | `NeosintezClient`, DTO‚Äë–º–æ–¥–µ–ª–∏, Enums |

---

## 4. –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–±–æ—Ç

### –®–∞–≥¬†1. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏ —Ä–∞–∑–±–æ—Ä –º–æ–Ω–æ–ª–∏—Ç–∞ (üïê¬†~1¬†–¥–µ–Ω—å)

| –î–µ–π—Å—Ç–≤–∏–µ | –§–∞–π–ª/–ø–∞–ø–∫–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|------------|-----------|
| 1.1 –°–æ–∑–¥–∞—Ç—å –ø–∞–∫–µ—Ç `neosintez_api/core` | `__init__.py`, `client.py`, `enums.py`, `exceptions.py` | –í—ã–¥–µ–ª—è–µ–º —Ç–æ–Ω–∫–∏–π SDK |
| 1.2 –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å dataclasses –∏–∑ swagger (–∏–ª–∏ `datamodel-codegen`) | `core/generated/` | –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ DTO |
| 1.3 –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ª–æ–≥–∏–∫—É –∫–µ—à–∞ –≤ `services/cache.py` | ‚Äî | –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ |

### –®–∞–≥¬†2. –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (üïê¬†~0.5¬†–¥–Ω—è)

1. –¢–∞–±–ª–∏—Ü–∞ –º–∞–ø–ø–∏–Ω–≥–∞ **Python‚Äë—Ç–∏–ø ‚Üí WioAttributeType** –≤ `enums.py`.
2. –§—É–Ω–∫—Ü–∏—è `build_attribute_body(meta, value)`:
   * –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç–∏–ø–æ–≤;
   * –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–∞—Ç (`datetime ‚Üí "YYYY‚ÄëMM‚ÄëDDTHH:MM:SSZ"`);
   * –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `Field(alias=‚Ä¶)`.

### –®–∞–≥¬†3. –°–µ—Ä–≤–∏—Å‚Äë—Å–ª–æ–π CRUD (üïê¬†~1.5¬†–¥–Ω—è)

| –ú–µ—Ç–æ–¥ | –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ |
|-------|-------------|
| `create(model, parent_id)` | 1¬†REST¬†–≤—ã–∑–æ–≤ ‚Äì POST `/objects` + 1 PUT `/objects/{id}/attributes` |
| `update_attrs(obj_id, model)` | –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∏ –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —à–ª—ë–º diff |
| `read(model_cls, obj_id)` | –î–æ—Å—Ç–∞—ë–º, –º–∞–ø–∏–º –∞—Ç—Ä–∏–±—É—Ç—ã¬†‚Üî –ø–æ–ª—è |

### –®–∞–≥¬†4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (üïê¬†~1¬†–¥–µ–Ω—å)

* **Unit**: –º–∞–ø–ø–∏–Ω–≥ —Ç–∏–ø–æ–≤, –∫—ç—à TTL, –≤–∞–ª–∏–¥–∞—Ü–∏—è.
* **Integration**: –º–æ–∫‚Äë—Å–µ—Ä–≤–µ—Ä respx/WireMock; —Å—Ü–µ–Ω–∞—Ä–∏–π *create ‚Üí read* –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω—É—é –º–æ–¥–µ–ª—å.
* GitHub¬†Actions workflow `pytest -q`.

### –®–∞–≥¬†5. –ò–º–ø–æ—Ä—Ç –∏–∑ Excel (üïê¬†~1.5¬†–¥–Ω—è)

1. `pip install pandas openpyxl`.
2. `excel_import.py`:
   ```python
   for row in df.itertuples():
       model = SomeModel(**row._asdict())
       await ObjectService.create(model, parent_id)
   ```
3. –ü—Ä–∏–º–µ–Ω—è–µ–º `asyncio.Semaphore(5)` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç–∏.
4. –ü–∏—à–µ–º –æ—Ç—á—ë—Ç `.xlsx` (—É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞, —Å–æ–∑–¥–∞–Ω–Ω—ã–π `Id`).

### –®–∞–≥¬†6. CLI –∏ —É–¥–æ–±—Å—Ç–≤–∞ (üïê¬†~0.5¬†–¥–Ω—è)

* `python -m neosintez_api.import_excel file.xlsx --model SomeModel --parent <GUID>`.
* –§–ª–∞–≥¬†`--dry-run`¬†‚Äî —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑ API‚Äë–∑–∞–ø—Ä–æ—Å–æ–≤.
* `tqdm` progress‚Äëbar.

### –®–∞–≥¬†7. –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

* FastAPI‚Äë–ø–ª–∞–≥–∏–Ω –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ CRUD.
* Bulk‚Äëupdate —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
* Retry + back‚Äëoff –Ω–∞ 429/503.
* –ê–≤—Ç–æ‚Äë–≥–µ–Ω–µ—Ä–∞—Ü–∏—è Pydantic‚Äë–∫–ª–∞—Å—Å–∞ –ø–æ Id —Å—É—â–Ω–æ—Å—Ç–∏.

---

## 5. –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ (Gantt‚Äë–Ω–∞–±—Ä–æ—Å–æ–∫)

| –ù–µ–¥–µ–ª—è | 1 | 2 | 3 |
|-------|---|---|---|
| üå±¬†–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —è–¥—Ä–∞ | ‚ñà‚ñà‚ñà | | |
| ‚öôÔ∏è¬†–ê—Ç—Ä–∏–±—É—Ç—ã + –°–µ—Ä–≤–∏—Å |  | ‚ñà‚ñà‚ñà | |
| ‚úÖ¬†–¢–µ—Å—Ç—ã |  | ‚ñà‚ñà | |
| üì•¬†Excel Import |  |  | ‚ñà‚ñà‚ñà |
| üöÄ¬†CLI & —Ä–µ–ª–∏–∑¬†0.1 |  |  | ‚ñí‚ñí |

---

## 6. –¢—Ä–µ–±—É–µ–º—ã–µ deliverables

* `neosintez_api/core/*.py` ‚Äì SDK.
* `neosintez_api/services/*.py` ‚Äì Cache & ObjectService.
* `examples/quick_start.py` ‚Äì –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä.
* `tests/` ‚Äì –ø–æ–ª–Ω—ã–π coverage >‚ÄØ80‚ÄØ%.
* `excel_import.py` + `README.md`.

---

## 7. –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

* Swagger¬†UI –ª–æ–∫–∞–ª—å–Ω–æ: `python -m aiohttp_swagger3 swagger.json`.
* Datamodel‚Äëcodegen: <https://github.com/koxudaxi/datamodel-code-generator>
* respx mock server: <https://github.com/lundberg/respx>

---

### –£–¥–∞—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã! üöÄ
